<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <title>ÆSI Builder</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.4/dist/tailwind.min.css" rel="stylesheet">
  <style>body{background:#000;color:#0f0;font-family:Consolas,monospace;}</style>
</head>
<body class="p-8">
<div id="global-nav"></div>
<h1 class="text-2xl font-bold mb-4">ÆSI Vision Builder</h1>
<textarea id="vision" class="w-full h-32 bg-black text-green-400 border border-green-600 p-2"></textarea>
<br><input id="key" type="password" placeholder="Gemini API Key" class="p-2 mt-2 bg-gray-900 text-green-300 w-full">
<br><button onclick="build()" class="mt-4 bg-green-700 px-4 py-2 rounded hover:bg-green-600">🚀 Bygg</button>
<pre id="log" class="mt-6 bg-gray-900 p-4 border border-gray-700 rounded h-60 overflow-y-auto"></pre>
<script src="/js/nav_menu.js"></script>
<script>
async function build(){
  const log = document.getElementById('log');
  const vision = document.getElementById('vision').value.trim();
  const key = document.getElementById('key').value.trim();
  if(!vision||!key){alert('Fyll i både vision och API-nyckel!');return;}
  log.textContent = '> Kontaktar Gemini...';
  const res = await fetch(\https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=\\, {
    method:"POST", headers:{ "Content-Type":"application/json"},
    body: JSON.stringify({ contents:[{ parts:[{ text:\Skapa en HTML-fil baserat på detta: "\". Returnera JSON {"filename":"namn.html","content":"<html>...</html>"}\}]}]})
  });
  const data = await res.json();
  try{
    const json = JSON.parse(data.candidates[0].content.parts[0].text.replace(/`json|`/g,''));
    log.textContent += "\n> Skickar till backend...";
    const send = await fetch('/api/build',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(json)});
    log.textContent += "\n"+await send.text();
  }catch(e){log.textContent += "\nFel: "+e.message;}
}
</script>
</body></html>
