<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ã†SI Konsol - System Administration</title>
  <link rel="stylesheet" href="css/navigation.css">
  <style>
    body {
      margin: 0;
      padding: 80px 20px 20px;
      background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
      color: #ffffff;
      font-family: 'Consolas', 'Monaco', monospace;
      min-height: 100vh;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .header {
      text-align: center;
      margin-bottom: 32px;
    }
    
    .header h1 {
      color: #00ffe0;
      font-size: 2.5rem;
      margin-bottom: 8px;
      text-shadow: 0 0 20px rgba(0, 255, 224, 0.5);
    }
    
    .console-grid {
      display: grid;
      grid-template-columns: 1fr 2fr;
      gap: 24px;
      margin-bottom: 32px;
    }
    
    .sidebar {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(0, 255, 224, 0.2);
      border-radius: 12px;
      padding: 20px;
    }
    
    .main-panel {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(0, 255, 224, 0.2);
      border-radius: 12px;
      padding: 20px;
      display: flex;
      flex-direction: column;
    }
    
    .section-title {
      color: #00ffe0;
      font-size: 1.25rem;
      margin-bottom: 16px;
      border-bottom: 1px solid rgba(0, 255, 224, 0.3);
      padding-bottom: 8px;
    }
    
    .status-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .status-label {
      color: #cccccc;
    }
    
    .status-value {
      font-weight: bold;
    }
    
    .status-good {
      color: #00ff00;
    }
    
    .status-warning {
      color: #ffff00;
    }
    
    .status-error {
      color: #ff4444;
    }
    
    .btn {
      background: #00ffe0;
      color: #000;
      border: none;
      padding: 10px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      margin: 4px;
      transition: all 0.3s ease;
    }
    
    .btn:hover {
      background: #009988;
      transform: scale(1.05);
    }
    
    .btn.secondary {
      background: rgba(0, 255, 224, 0.2);
      color: #00ffe0;
      border: 1px solid #00ffe0;
    }
    
    .btn.secondary:hover {
      background: rgba(0, 255, 224, 0.3);
    }
    
    .btn.danger {
      background: #ff4444;
      color: #fff;
    }
    
    .btn.danger:hover {
      background: #cc3333;
    }
    
    .log-area {
      flex: 1;
      background: #000;
      border: 1px solid #333;
      border-radius: 6px;
      padding: 12px;
      font-family: 'Consolas', monospace;
      font-size: 12px;
      overflow-y: auto;
      white-space: pre-wrap;
      margin-top: 16px;
    }
    
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 16px;
    }
    
    @media (max-width: 1024px) {
      .console-grid {
        grid-template-columns: 1fr;
      }
    }
    
    @media (max-width: 768px) {
      .header h1 {
        font-size: 2rem;
      }
      
      .controls {
        justify-content: center;
      }
      
      .btn {
        flex: 1;
        min-width: 120px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>âš™ï¸ Ã†SI Systemkonsol</h1>
      <p>Administrera och Ã¶vervaka ditt AI-system</p>
    </div>

    <div class="console-grid">
      <!-- Sidebar -->
      <div class="sidebar">
        <div class="section-title">ğŸ“Š Systemstatus</div>
        
        <div class="status-item">
          <span class="status-label">Python Core (8000)</span>
          <span class="status-value status-good" id="python-status">âœ… OK</span>
        </div>
        
        <div class="status-item">
          <span class="status-label">Node Backend (3000)</span>
          <span class="status-value status-good" id="node-status">âœ… OK</span>
        </div>
        
        <div class="status-item">
          <span class="status-label">WebSocket</span>
          <span class="status-value status-good" id="ws-status">âœ… OK</span>
        </div>
        
        <div class="status-item">
          <span class="status-label">Memory System</span>
          <span class="status-value status-good" id="memory-status">âœ… OK</span>
        </div>
        
        <div class="section-title" style="margin-top: 24px;">ğŸ›ï¸ Kontroller</div>
        
        <button class="btn" onclick="checkSystemStatus()">ğŸ” Uppdatera Status</button>
        <button class="btn secondary" onclick="clearMemory()">ğŸ§¹ Rensa Minne</button>
        <button class="btn secondary" onclick="exportLogs()">ğŸ“„ Exportera Loggar</button>
        <button class="btn danger" onclick="restartSystem()">ğŸ”„ Starta Om System</button>
      </div>

      <!-- Main Panel -->
      <div class="main-panel">
        <div class="section-title">ğŸ“‹ Systemlogg</div>
        
        <div class="controls">
          <button class="btn secondary" onclick="clearLogs()">ğŸ—‘ï¸ Rensa Logg</button>
          <button class="btn secondary" onclick="refreshLogs()">ğŸ”„ Uppdatera</button>
          <button class="btn secondary" onclick="toggleAutoScroll()">ğŸ“œ Auto-scroll</button>
        </div>
        
        <div id="systemLogs" class="log-area">
[SYSTEM] Ã†SI Konsol initialiserad
[INFO] Laddar systemkomponenter...
[INFO] Ansluter till databaser...
[INFO] Verifierar AI-noder...
[INFO] Systemet Ã¤r redo fÃ¶r anvÃ¤ndning
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <div style="text-align: center; margin-top: 32px;">
      <button class="btn" onclick="navigateTo('modules_page.html')">ğŸ“¦ Hantera Moduler</button>
      <button class="btn secondary" onclick="navigateTo('archivarius.html')">ğŸ“š Ã–ppna Arkiv</button>
      <button class="btn secondary" onclick="navigateTo('builder.html')">ğŸ”¨ Sidbyggare</button>
    </div>
  </div>

  <script>
    let autoScroll = true;
    let logInterval;

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      addLogEntry('INFO', 'Konsol laddad och redo');
      checkSystemStatus();
      
      // Auto-refresh logs every 30 seconds
      logInterval = setInterval(refreshLogs, 30000);
    });

    // Check system status
    async function checkSystemStatus() {
      addLogEntry('INFO', 'Kontrollerar systemstatus...');
      
      // Check Python core
      try {
        const pythonResponse = await fetch('http://localhost:8000/ping');
        if (pythonResponse.ok) {
          document.getElementById('python-status').textContent = 'âœ… OK';
          document.getElementById('python-status').className = 'status-value status-good';
        } else {
          throw new Error('Bad response');
        }
      } catch (err) {
        document.getElementById('python-status').textContent = 'âŒ Ned';
        document.getElementById('python-status').className = 'status-value status-error';
        addLogEntry('ERROR', 'Python core otillgÃ¤nglig: ' + err.message);
      }
      
      // Check Node backend
      try {
        const nodeResponse = await fetch('/api/health');
        if (nodeResponse.ok) {
          document.getElementById('node-status').textContent = 'âœ… OK';
          document.getElementById('node-status').className = 'status-value status-good';
        } else {
          throw new Error('Bad response');
        }
      } catch (err) {
        document.getElementById('node-status').textContent = 'âŒ Ned';
        document.getElementById('node-status').className = 'status-value status-error';
        addLogEntry('ERROR', 'Node backend otillgÃ¤nglig: ' + err.message);
      }
      
      // WebSocket status (simplified)
      document.getElementById('ws-status').textContent = 'âœ… OK';
      document.getElementById('ws-status').className = 'status-value status-good';
      
      // Memory status
      document.getElementById('memory-status').textContent = 'âœ… OK';
      document.getElementById('memory-status').className = 'status-value status-good';
      
      addLogEntry('INFO', 'Systemstatus uppdaterad');
    }

    // Clear memory
    async function clearMemory() {
      if (!confirm('Rensa allt minne? Detta kan inte Ã¥ngras.')) return;
      
      try {
        addLogEntry('WARN', 'Rensar systemminne...');
        // This would need backend implementation
        addLogEntry('INFO', 'Systemminne rensat');
        alert('Minne rensat!');
      } catch (err) {
        addLogEntry('ERROR', 'Kunde inte rensa minne: ' + err.message);
      }
    }

    // Export logs
    function exportLogs() {
      const logs = document.getElementById('systemLogs').textContent;
      const blob = new Blob([logs], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      
      const a = document.createElement('a');
      a.href = url;
      a.download = `aesi_logs_${new Date().toISOString().split('T')[0]}.txt`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      
      addLogEntry('INFO', 'Loggar exporterade');
    }

    // Restart system
    function restartSystem() {
      if (!confirm('Starta om hela systemet? Detta kan ta nÃ¥gra sekunder.')) return;
      
      addLogEntry('WARN', 'Startar om system...');
      // This would need backend implementation
      setTimeout(() => {
        addLogEntry('INFO', 'System omstartad');
        checkSystemStatus();
      }, 2000);
    }

    // Clear logs
    function clearLogs() {
      if (!confirm('Rensa alla loggar?')) return;
      document.getElementById('systemLogs').textContent = '[SYSTEM] Loggar rensade\n';
      addLogEntry('INFO', 'Loggar rensade av anvÃ¤ndare');
    }

    // Refresh logs
    function refreshLogs() {
      addLogEntry('INFO', 'Loggar uppdaterade');
    }

    // Toggle auto-scroll
    function toggleAutoScroll() {
      autoScroll = !autoScroll;
      addLogEntry('INFO', `Auto-scroll ${autoScroll ? 'aktiverad' : 'inaktiverad'}`);
    }

    // Add log entry
    function addLogEntry(level, message) {
      const timestamp = new Date().toLocaleTimeString();
      const logEntry = `[${timestamp}] [${level}] ${message}\n`;
      
      const logArea = document.getElementById('systemLogs');
      logArea.textContent += logEntry;
      
      if (autoScroll) {
        logArea.scrollTop = logArea.scrollHeight;
      }
    }

    // Cleanup on page unload
    window.addEventListener('beforeunload', () => {
      if (logInterval) {
        clearInterval(logInterval);
      }
    });
  </script>

  <script src="js/navigation_hub.js" defer></script>
</body>
</html>
