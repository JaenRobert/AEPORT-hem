<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ã†SI Moduler - Module Management</title>
  <link rel="stylesheet" href="css/navigation.css">
  <style>
    body {
      margin: 0;
      padding: 80px 20px 20px;
      background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
      color: #ffffff;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      min-height: 100vh;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .header {
      text-align: center;
      margin-bottom: 32px;
    }
    
    .header h1 {
      color: #00ffe0;
      font-size: 2.5rem;
      margin-bottom: 8px;
      text-shadow: 0 0 20px rgba(0, 255, 224, 0.5);
    }
    
    .modules-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 24px;
    }
    
    .module-card {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(0, 255, 224, 0.2);
      border-radius: 12px;
      padding: 20px;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .module-card:hover {
      border-color: #00ffe0;
      transform: translateY(-4px);
      box-shadow: 0 8px 24px rgba(0, 255, 224, 0.2);
    }
    
    .module-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
    }
    
    .module-icon {
      font-size: 2rem;
      margin-right: 12px;
    }
    
    .module-title {
      color: #00ffe0;
      font-size: 1.25rem;
      margin: 0;
    }
    
    .module-status {
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 600;
    }
    
    .status-active {
      background: rgba(0, 255, 0, 0.2);
      color: #00ff00;
    }
    
    .status-inactive {
      background: rgba(255, 255, 0, 0.2);
      color: #ffff00;
    }
    
    .status-error {
      background: rgba(255, 0, 0, 0.2);
      color: #ff6666;
    }
    
    .module-description {
      color: #cccccc;
      margin-bottom: 16px;
      line-height: 1.5;
    }
    
    .module-controls {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    
    .btn {
      background: #00ffe0;
      color: #000;
      border: none;
      padding: 6px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      font-size: 0.9rem;
      transition: all 0.3s ease;
    }
    
    .btn:hover {
      background: #009988;
      transform: scale(1.05);
    }
    
    .btn.secondary {
      background: rgba(0, 255, 224, 0.2);
      color: #00ffe0;
      border: 1px solid #00ffe0;
    }
    
    .btn.secondary:hover {
      background: rgba(0, 255, 224, 0.3);
    }
    
    .btn.danger {
      background: #ff4444;
      color: #fff;
    }
    
    .btn.danger:hover {
      background: #cc3333;
    }
    
    .module-details {
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid rgba(0, 255, 224, 0.2);
      font-size: 0.85rem;
      color: #999;
    }
    
    .system-info {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(0, 255, 224, 0.2);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 32px;
    }
    
    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin-top: 16px;
    }
    
    .info-item {
      text-align: center;
    }
    
    .info-value {
      font-size: 1.5rem;
      font-weight: bold;
      color: #00ffe0;
      display: block;
    }
    
    .info-label {
      font-size: 0.9rem;
      color: #cccccc;
    }
    
    @media (max-width: 768px) {
      .modules-grid {
        grid-template-columns: 1fr;
      }
      
      .header h1 {
        font-size: 2rem;
      }
      
      .module-controls {
        justify-content: center;
      }
      
      .info-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ðŸ“¦ Ã†SI Moduler</h1>
      <p>Hantera och konfigurera systemmoduler</p>
    </div>

    <!-- System Info -->
    <div class="system-info">
      <h3 style="color: #00ffe0; margin-bottom: 8px;">ðŸ“Š SystemÃ¶versikt</h3>
      <div class="info-grid">
        <div class="info-item">
          <span class="info-value" id="totalModules">8</span>
          <span class="info-label">Totala moduler</span>
        </div>
        <div class="info-item">
          <span class="info-value status-active" id="activeModules">7</span>
          <span class="info-label">Aktiva moduler</span>
        </div>
        <div class="info-item">
          <span class="info-value" id="systemUptime">00:00:00</span>
          <span class="info-label">Drifttid</span>
        </div>
        <div class="info-item">
          <span class="info-value" id="memoryUsage">0 MB</span>
          <span class="info-label">Minne</span>
        </div>
      </div>
    </div>

    <!-- Modules Grid -->
    <div class="modules-grid" id="modulesGrid">
      <!-- Modules will be loaded here -->
    </div>
  </div>

  <script>
    let modules = [];
    let systemStartTime = Date.now();

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      initializeModules();
      updateSystemStats();
      setInterval(updateSystemStats, 5000); // Update every 5 seconds
    });

    // Initialize modules
    function initializeModules() {
      modules = [
        {
          id: 'navigation',
          name: 'Navigation',
          description: 'Global navigationssystem fÃ¶r alla sidor',
          icon: 'ðŸ§­',
          status: 'active',
          version: '3.0',
          dependencies: [],
          lastUsed: new Date().toISOString()
        },
        {
          id: 'ai_core',
          name: 'AI Core',
          description: 'Python-baserad AI-motor med 7 noder',
          icon: 'ðŸ¤–',
          status: 'active',
          version: '5.0',
          dependencies: ['python'],
          lastUsed: new Date().toISOString()
        },
        {
          id: 'chat_system',
          name: 'Chat System',
          description: 'Real-tidschatt med AI-integration',
          icon: 'ðŸ’¬',
          status: 'active',
          version: '4.0',
          dependencies: ['ai_core', 'websocket'],
          lastUsed: new Date().toISOString()
        },
        {
          id: 'page_builder',
          name: 'Sidbyggare',
          description: 'Visuell sidbyggare med drag & drop',
          icon: 'ðŸ”¨',
          status: 'active',
          version: '3.0',
          dependencies: ['monaco'],
          lastUsed: new Date().toISOString()
        },
        {
          id: 'memory_system',
          name: 'Minnessystem',
          description: 'Konversationshistorik och datalagring',
          icon: 'ðŸ§ ',
          status: 'active',
          version: '2.0',
          dependencies: ['database'],
          lastUsed: new Date().toISOString()
        },
        {
          id: 'archive_manager',
          name: 'Arkivhanterare',
          description: 'Dataarkivering och historikhantering',
          icon: 'ðŸ“š',
          status: 'active',
          version: '2.0',
          dependencies: ['filesystem'],
          lastUsed: new Date().toISOString()
        },
        {
          id: 'deployment_system',
          name: 'Distributionssystem',
          description: 'Automatisk distribution till Netlify',
          icon: 'ðŸš€',
          status: 'active',
          version: '3.0',
          dependencies: ['netlify'],
          lastUsed: new Date().toISOString()
        },
        {
          id: 'console_admin',
          name: 'Admin-konsol',
          description: 'Systemadministration och Ã¶vervakning',
          icon: 'âš™ï¸',
          status: 'active',
          version: '2.0',
          dependencies: ['system'],
          lastUsed: new Date().toISOString()
        }
      ];

      renderModules();
    }

    // Render modules
    function renderModules() {
      const grid = document.getElementById('modulesGrid');
      
      grid.innerHTML = modules.map(module => `
        <div class="module-card" data-id="${module.id}">
          <div class="module-header">
            <div style="display: flex; align-items: center;">
              <span class="module-icon">${module.icon}</span>
              <h3 class="module-title">${module.name}</h3>
            </div>
            <span class="module-status status-${module.status}">
              ${module.status === 'active' ? 'AKTIV' : 'INAKTIV'}
            </span>
          </div>
          
          <p class="module-description">${module.description}</p>
          
          <div class="module-controls">
            <button class="btn ${module.status === 'active' ? 'secondary' : ''}" 
                    onclick="toggleModule('${module.id}')">
              ${module.status === 'active' ? 'Inaktivera' : 'Aktivera'}
            </button>
            <button class="btn secondary" onclick="configureModule('${module.id}')">
              Konfigurera
            </button>
            <button class="btn secondary" onclick="viewModuleInfo('${module.id}')">
              Info
            </button>
          </div>
          
          <div class="module-details">
            Version: ${module.version} â€¢ 
            Senast anvÃ¤nd: ${new Date(module.lastUsed).toLocaleDateString('sv-SE')}
          </div>
        </div>
      `).join('');
    }

    // Toggle module status
    function toggleModule(moduleId) {
      const module = modules.find(m => m.id === moduleId);
      if (!module) return;
      
      if (module.status === 'active') {
        // Check dependencies before deactivating
        const dependentModules = modules.filter(m => 
          m.dependencies && m.dependencies.includes(moduleId) && m.status === 'active'
        );
        
        if (dependentModules.length > 0) {
          alert(`Kan inte inaktivera ${module.name}. FÃ¶ljande moduler Ã¤r beroende:\n${dependentModules.map(m => '- ' + m.name).join('\n')}`);
          return;
        }
        
        module.status = 'inactive';
        alert(`${module.name} inaktiverad`);
      } else {
        // Check if dependencies are available
        const missingDeps = module.dependencies.filter(dep => 
          !modules.find(m => m.id === dep && m.status === 'active')
        );
        
        if (missingDeps.length > 0) {
          alert(`Kan inte aktivera ${module.name}. FÃ¶ljande beroenden saknas:\n${missingDeps.join('\n')}`);
          return;
        }
        
        module.status = 'active';
        alert(`${module.name} aktiverad`);
      }
      
      module.lastUsed = new Date().toISOString();
      renderModules();
      updateSystemStats();
    }

    // Configure module
    function configureModule(moduleId) {
      const module = modules.find(m => m.id === moduleId);
      if (!module) return;
      
      const config = prompt(`Konfigurera ${module.name}:`, JSON.stringify({
        version: module.version,
        autoStart: true,
        debug: false
      }, null, 2));
      
      if (config) {
        try {
          const parsedConfig = JSON.parse(config);
          alert(`${module.name} konfigurerad:\n${JSON.stringify(parsedConfig, null, 2)}`);
        } catch (e) {
          alert('Ogiltig JSON-konfiguration');
        }
      }
    }

    // View module info
    function viewModuleInfo(moduleId) {
      const module = modules.find(m => m.id === moduleId);
      if (!module) return;
      
      alert(`${module.icon} ${module.name} v${module.version}

Beskrivning: ${module.description}

Status: ${module.status.toUpperCase()}
Senast anvÃ¤nd: ${new Date(module.lastUsed).toLocaleDateString('sv-SE')}

Beroenden: ${module.dependencies.length > 0 ? module.dependencies.join(', ') : 'Inga'}

Systeminformation:
- ID: ${module.id}
- Version: ${module.version}
- Aktiverad: ${module.status === 'active' ? 'Ja' : 'Nej'}`);
    }

    // Update system statistics
    function updateSystemStats() {
      const activeModules = modules.filter(m => m.status === 'active').length;
      const uptime = Math.floor((Date.now() - systemStartTime) / 1000);
      const hours = Math.floor(uptime / 3600);
      const minutes = Math.floor((uptime % 3600) / 60);
      const seconds = uptime % 60;
      
      document.getElementById('totalModules').textContent = modules.length;
      document.getElementById('activeModules').textContent = activeModules;
      document.getElementById('systemUptime').textContent = 
        `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
      
      // Simulate memory usage
      const memoryUsage = Math.floor(Math.random() * 50) + 100;
      document.getElementById('memoryUsage').textContent = `${memoryUsage} MB`;
    }

    // Export module configuration
    window.exportModules = function() {
      const data = {
        exported_at: new Date().toISOString(),
        modules: modules
      };
      
      const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      
      const a = document.createElement('a');
      a.href = url;
      a.download = 'aesi_modules_config.json';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      
      alert('Modulkonfiguration exporterad!');
    };

    // Import module configuration
    window.importModules = function() {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.json';
      input.onchange = function(e) {
        const file = e.target.files[0];
        const reader = new FileReader();
        reader.onload = function(e) {
          try {
            const data = JSON.parse(e.target.result);
            if (data.modules) {
              modules = data.modules;
              renderModules();
              updateSystemStats();
              alert('Modulkonfiguration importerad!');
            }
          } catch (err) {
            alert('Ogiltig konfigurationsfil: ' + err.message);
          }
        };
        reader.readAsText(file);
      };
      input.click();
    };
  </script>

  <script src="js/navigation_hub.js" defer></script>
</body>
</html>

